# =========================================================================== #
# Pipeline
# =========================================================================== #
paths:
  name: "Name"
  data: "/path/to/data/"
  pattern: "*.fits"
  pype: "/path/to/vircampype/"

misc:
  silent: False
  overwrite: False
  qc_plots: True
  n_jobs: 8
  fix_vircam_header: True
  reset_wcs: True


# =========================================================================== #
# Keywords
# =========================================================================== #
keywords:
  object: "OBJECT"
  filter: "HIERARCH ESO INS FILT1 NAME"
  type: "HIERARCH ESO DPR TYPE"
  category: "HIERARCH ESO DPR CATG"
  dit: "HIERARCH ESO DET DIT"
  ndit: "HIERARCH ESO DET NDIT"
  date_mjd: "MJD-OBS"
  date_ut: "DATE-OBS"
  gain: "GAIN"
  rdnoise: "RDNOISE"
  saturate: "SATURATE"


# =========================================================================== #
# Calibration
# =========================================================================== #
master:
  max_lag_bpm: 10                    # Maximum time difference to MasterBPM in days
  max_lag_dark: 10                   # Maximum time difference to MasterDark in days
  max_lag_flat: 10                   # Maximum time difference to MasterFlat in days
  max_lag_superflat: 60              # Maximum time difference to MasterSuperflat in minutes
  max_lag_sky: 60                    # Maximum time difference to MasterSky in minutes
  max_lag_gain: 10                   # Maximum time difference to MasterGain in days
  max_lag_weight: 10                 # Maximum time difference to MasterWright in days
  max_lag_linearity: 10              # Maximum time difference to MasterLinearity in days

sky:
  mix_science: True                 # This is not yet used
  window: 180                       # Window in minutes around which sky images are created
  n_min: 5                          # Minimum number of images to merge to an offset image
  mask_min: False
  mask_max: True
  sigma_level: 3
  sigma_iter: 1
  mask_sources: True
  mask_sources_thresh: 5
  mask_sources_min_area: 3
  mask_sources_max_area: 250000     # 500 x 500 pix
  background_mesh_size: 256
  background_mesh_filter_size: 3
  collapse_metric: "median"
  mode: "background"

superflat:
  window: 120
  n_min: 5
  nbins_x: 15
  nbins_y: 15
  kernel_scale: 0.2

cosmetics:
  mask_cosmics: False
  destripe: True
  destripe_axis: 2
  destripe_method: "median"

interpolation:
  interpolate_nan: True
  max_bad_neighbors: 3


# =========================================================================== #
# Photometry
# =========================================================================== #
photometry:
  reference: 2mass
  mag_limits_ref: 12.0,15.0
  distance_groups: 1
  margin: 0.1
  apcor_func: moffat                # Function for aperture correction fitting
  apcor_image_scale: 0.2            # Scale factor for aperture correction output image


# =========================================================================== #
# Astromatic
# =========================================================================== #
astromatic:
  bin_sex: sex
  bin_scamp: scamp
  bin_swarp: swarp
  pixel_scale: 1/3
  swarp_back_size: 128


# =========================================================================== #
# Compression
# =========================================================================== #
compression:
  compress_phase3: False
  bin_fpack: fpack
  quantize_level: 32
